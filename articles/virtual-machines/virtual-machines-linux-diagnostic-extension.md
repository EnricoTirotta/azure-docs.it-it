	<properties		pageTitle="using linux diagnostic extension to monitor linux vm’s performance and diagnostic data"		description="Learn how to linux diagnostic extension to monitor linux vm’s performance and diagnostic data."		services="virtual-machines"		documentationCenter=""    	authors="Ning"		manager="timlt"		editor=""    	tags=""/>	<tags		ms.service="virtual-machines"		ms.workload="infrastructure-services"		ms.tgt_pltfrm="vm-linux"		ms.devlang="na"		ms.topic="article"		ms.date="06/04/2015"		ms.author="Ning"/>#Uso dell'estensione di diagnostica Linux per monitorare le prestazioni delle macchine virtuali Linux e i dati di diagnostica##Introduzione L'estensione di diagnostica Linux consente all'utente di monitorare le macchine virtuali Linux eseguite in Azure, con le funzionalità seguenti:1.	Raccoglie e carica i dati relativi alla prestazioni del sistema, alla diagnostica e a syslog delle macchine virtuali Linux nella tabella di archiviazione dell'utente.2.	Consente all'utente di personalizzare la metrica dei dati che verrà raccolta e caricata.	3.	Consente all'utente di caricare nella tabella di archiviazione designata i file di log specificati.Per la versione 2.0, i dati includono:1.	Tutte le registrazioni Rsyslog Linux, inclusi i log di sistema, sicurezza e applicazioni.2.	Tutti i dati di sistema specificati in questo [documento](https://scx.codeplex.com/wikipage?title=xplatproviders&referringTitle=Documentation "documento").3.	I file di log specificati dall'utente.##Come abilitare l'estensione L'estensione può essere abilitata tramite il portale di gestione di Azure, Azure PowerShell o gli script dell'interfaccia della riga di comando di Azure.Per visualizzare e configurare i dati di sistema e prestazioni direttamente dal [portale di gestione di Azure](https://ms.portal.azure.com/#), seguire questa [procedura](http://azure.microsoft.com/blog/2014/09/02/windows-azure-virtual-machine-monitoring-with-wad-extension/ "URL del blog di Windows"). Questo articolo è incentrato sull'abilitazione e la configurazione dell'estensione tramite i comandi dell'interfaccia della riga di comando di Azure. In questo modo è possibile leggere e visualizzare i dati direttamente dalla tabella di archiviazione.##Prerequisiti1. Agente Linux di Microsoft Azure 2.0.6 o versioni successive. Si noti che la maggior parte delle immagini della raccolta Linux di macchine virtuali di Azure include la versione 2.0.6 indicata precedentemente. È possibile eseguire WAAgent -version per verificare la versione installata nella macchina virtuale. Se la macchina virtuale esegue una versione precedente alla 2.0.6, è possibile seguire queste [istruzioni](https://github.com/Azure/WALinuxAgent "istruzioni") per aggiornarla.2.  [Interfaccia della riga di comando di Azure](./xplat-cli.md "Interfaccia della riga di comando di Azure") Seguire [queste informazioni aggiuntive](./xplat-cli-install.md "queste informazioni aggiuntive") per configurare l'ambiente dell'interfaccia della riga di comando di Azure nella macchina virtuale. Dopo l'installazione dell'interfaccia della riga di comando di Azure, sarà possibile usare il comando azure dall'interfaccia della riga di comando (prompt dei comandi, bash, terminale) per accedere ai comandi dell'interfaccia della riga di comando di Azure. Eseguire ad esempio 'azure vm extension set --help' per ottenere informazioni dettagliate sull'utilizzo, eseguire 'azure login' per accedere ad Azure oppure eseguire 'azure vm list' per elencare tutte le macchine virtuali disponibili in Azure.3. Account di archiviazione per archiviare i dati. Saranno necessari un nome di account di archiviazione e una chiave di accesso creati in precedenza per caricare i dati nella risorsa di archiviazione.##Usare l'interfaccia della riga di comando di Azure per abilitare l'estensione della diagnostica Linux ###  Scenario 1. Abilitare l'estensione con il set di dati predefinitoPer la versione 2.0 e versioni successive, i dati predefiniti che verranno raccolti includono: 1. Tutte le informazioni Rsyslog, inclusi i log di sistema, sicurezza e applicazioni.  2. Un set di dati di sistema di base. Il set di dati completo è descritto in questo [documento](https://scx.codeplex.com/wikipage?title=xplatproviders&referringTitle=Documentation "documento"). Per abilitare dati aggiuntivi, proseguire con i passaggi 2 e 3 dello scenario.Passaggio 1. Creare un file denominato PrivateConfig.json con il contenuto seguente:	{     	"storageAccountName":"the storage account to receive data",     	"storageAccountKey":"the key of the account"	}Passaggio 2. Eseguire 'azure vm extension set vm_name LinuxDiagnostic Microsoft.OSTCExtensions 2.* --private-config-path PrivateConfig.json'.###   Scenario 2. Personalizzare la metrica di monitoraggio delle prestazioni  Per personalizzare la tabella dei dati di diagnostica e prestazioni, seguire la procedura descritta di seguito.Passaggio 1. Creare un file denominato PrivateConfig.json con il contenuto seguente e specificare i dati che si intende raccogliere.Per tutti i provider e le variabili supportati, fare riferimento a questo [documento](https://scx.codeplex.com/wikipage?title=xplatproviders&referringTitle=Documentation "documento"). È possibile disporre di più query e archiviarle in più tabelle aggiungendo altre query nello script.Si noti che per impostazione predefinita i dati Rsyslog verranno sempre raccolti.	{     	"storageAccountName":"storage account to receive data",     	"storageAccountKey":"key of the account",      	"perfCfg":[           	{"query":"SELECT PercentAvailableMemory, AvailableMemory, UsedMemory ,PercentUsedSwap FROM SCX_MemoryStatisticalInformation","table":"LinuxMemory"           	}             ]	}Passaggio 2. Eseguire 'azure vm extension set vm_name LinuxDiagnostic Microsoft.OSTCExtensions 2.* --private-config-path PrivateConfig.json'.###   Scenario 3. Caricamento dei propri file di logPer raccogliere file di log specifici e caricarli nell'account di archiviazione, seguire la procedura descritta di seguito. È necessario specificare il percorso del file di log e il nome della tabella in cui archiviare il log. È possibile disporre di più file di log aggiungendo più voci di file/tabella nello script.Passaggio 1. Creare un file denominato PrivateConfig.json con il contenuto seguente:	{     	"storageAccountName":"the storage account to receive data",     	"storageAccountKey":"key of the account",      	"fileCfg":[           	{"file":"/var/log/mysql.err",             "table":"mysqlerr"           	}           ]	}Passaggio 2. Eseguire 'azure vm extension set vm_name LinuxDiagnostic Microsoft.OSTCExtensions 2.* --private-config-path PrivateConfig.json'.###   Scenario 4. Disabilitare l'estensione di monitoraggio LinuxPassaggio 1. Creare un file denominato PrivateConfig.json con il contenuto seguente:	{     	"storageAccountName":"the storage account to receive data",     	"storageAccountKey":"the key of the account",     	“perfCfg”:[],     	“enableSyslog”:”False”	}Passaggio 2. Eseguire 'azure vm extension set vm_name LinuxDiagnostic Microsoft.OSTCExtensions 2.* --private-config-path PrivateConfig.json'.##Esaminare i datiI dati relativi alle prestazioni e alla diagnostica sono archiviati nella tabella di archiviazione di Azure. Vedere [questo articolo](./storage-ruby-how-to-use-table-storage.md "questo articolo") per informazioni su come accedere ai dati della tabella di archiviazione tramite gli script dell'interfaccia della riga di comando di Azure.È anche possibile usare gli strumenti dell'interfaccia utente seguenti per accedere ai dati:1.	Utilizzare Esplora server di Visual Studio. Passare all'account di archiviazione. Dopo aver eseguito la macchina virtuale per circa cinque minuti, dovrebbero essere visibili le tabelle predefinite, ovvero "LinuxCpu", "LinuxDisk", "LinuxMemory" e "Linuxsyslog". Fare doppio clic sul nome della tabella per visualizzare i dati. 2.	Usare [Esplora archivi Azure](https://azurestorageexplorer.codeplex.com/ "Esplora archivi Azure") per accedere ai dati. ![immagine](./media/virtual-machines-linux-diagnostic-extension/no1.png)Se è stato abilitato fileCfg o perfCfg, specificati negli scenari 2 e 3, sarà anche possibile visualizzare dati non predefiniti con gli strumenti indicati precedentemente.##Problemi noti1. Per la versione 2.0, le informazioni Rsyslog e il file di log specificato dal cliente sono accessibili solo tramite scripting.2. Per la versione 2.0, se l'estensione di diagnostica Linux è stata abilitata prima tramite script, non sarà possibile visualizzare i dati dal portale. Se invece si abilita l'estensione prima dal portale, gli script funzioneranno comunque.Si prevede che entrambi i problemi verranno risolti nella prossima versione. 

<!---HONumber=July15_HO4-->